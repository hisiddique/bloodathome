import{c as z,j as s,F,H as R,r as O}from"./app-DKMZLzfm.js";import{b as P,c as q,C as H,d as D}from"./card-Ct3FmLMH.js";import{a as G,b as U,c as V,A as J}from"./app-layout-mDgHwkxe.js";import{S as K,M as Q}from"./message-thread-DvtN3pcT.js";import{B as W}from"./button-BpuFCFGL.js";import{I as X}from"./input-aT928qqq.js";import{r as L}from"./stripe-DEhpSmJl.js";/* empty css            */import"./mapbox-fioGkFd4.js";import"./sheet-COscS31w.js";import"./x-CVwgNE2J.js";import"./index--92RBgGL.js";import"./index-B_ybs1te.js";import"./index-Cns2SMks.js";import"./index-CO8lL1Hs.js";import"./index-DAEGULsz.js";import"./index-CMWG4mbA.js";import"./clock-Br7JvzSP.js";import"./map-pin-6HZ9aDy_.js";import"./message-circle-BH8WnjW2.js";import"./index-BdQq_4o_.js";import"./format-BqGRHkU_.js";import"./isSameDay-IV5ClnVe.js";function Y(o){const e=z.c(7),{action:t,placeholder:n,disabled:m}=o,c=n===void 0?"Type your message...":n,i=m===void 0?!1:m;let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a={preserveScroll:!0},e[0]=a):a=e[0];let l;e[1]!==i||e[2]!==c?(l=y=>{const{processing:p}=y;return s.jsxs("div",{className:"flex gap-2",children:[s.jsx(X,{name:"content",placeholder:c,required:!0,disabled:p||i,autoComplete:"off"}),s.jsx(W,{type:"submit",disabled:p||i,size:"icon",children:s.jsx(K,{className:"size-4"})})]})},e[1]=i,e[2]=c,e[3]=l):l=e[3];let r;return e[4]!==t||e[5]!==l?(r=s.jsx("div",{className:"border-t p-4",children:s.jsx(F,{action:t,method:"post",resetOnSuccess:!0,options:a,id:"message-form",children:l})}),e[4]=t,e[5]=l,e[6]=r):r=e[6],r}const Z=5e3;function ye(o){const e=z.c(49),{conversation:t,messages:n}=o;let m;e[0]!==n?(m=n===void 0?[]:n,e[0]=n,e[1]=m):m=e[1];const c=m,[i]=L.useState(!0);let a;e[2]===Symbol.for("react.memo_cache_sentinel")?(a={title:"Messages",href:"/chat"},e[2]=a):a=e[2];const l=`/chat/${t.id}`;let r;e[3]!==t.phlebotomist_name||e[4]!==l?(r=[a,{title:t.phlebotomist_name,href:l}],e[3]=t.phlebotomist_name,e[4]=l,e[5]=r):r=e[5];const y=r;let p,A;e[6]!==i?(p=()=>{if(!i)return;const B=setInterval(se,Z);return()=>clearInterval(B)},A=[i],e[6]=i,e[7]=p,e[8]=A):(p=e[7],A=e[8]),L.useEffect(p,A);let k;e[9]!==c?(k=c.map(te),e[9]=c,e[10]=k):k=e[10];const M=k,T=`Chat with ${t.phlebotomist_name}`;let d;e[11]!==T?(d=s.jsx(R,{title:T}),e[11]=T,e[12]=d):d=e[12];const $=t.phlebotomist_image||"/placeholder.svg";let f;e[13]!==t.phlebotomist_name||e[14]!==$?(f=s.jsx(G,{src:$,alt:t.phlebotomist_name}),e[13]=t.phlebotomist_name,e[14]=$,e[15]=f):f=e[15];let h;e[16]!==t.phlebotomist_name?(h=t.phlebotomist_name.split(" ").map(ee).join("").toUpperCase().slice(0,2),e[16]=t.phlebotomist_name,e[17]=h):h=e[17];let u;e[18]!==h?(u=s.jsx(U,{children:h}),e[18]=h,e[19]=u):u=e[19];let x;e[20]!==f||e[21]!==u?(x=s.jsxs(V,{className:"size-12",children:[f,u]}),e[20]=f,e[21]=u,e[22]=x):x=e[22];let _;e[23]!==t.phlebotomist_name?(_=s.jsx(P,{className:"text-lg",children:t.phlebotomist_name}),e[23]=t.phlebotomist_name,e[24]=_):_=e[24];let b;e[25]!==t.booking_id?(b=t.booking_id.slice(0,8),e[25]=t.booking_id,e[26]=b):b=e[26];let j;e[27]!==b?(j=s.jsxs(q,{children:["Booking #",b]}),e[27]=b,e[28]=j):j=e[28];let g;e[29]!==_||e[30]!==j?(g=s.jsxs("div",{children:[_,j]}),e[29]=_,e[30]=j,e[31]=g):g=e[31];let v;e[32]!==x||e[33]!==g?(v=s.jsx(H,{className:"mb-4",children:s.jsx(D,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[x,g]})})}),e[32]=x,e[33]=g,e[34]=v):v=e[34];let N;e[35]!==M?(N=s.jsx(Q,{messages:M,className:"flex-1"}),e[35]=M,e[36]=N):N=e[36];const w=`/chat/${t.id}/messages`;let C;e[37]!==w?(C=s.jsx(Y,{action:w}),e[37]=w,e[38]=C):C=e[38];let I;e[39]!==N||e[40]!==C?(I=s.jsxs(H,{className:"flex flex-1 flex-col overflow-hidden",children:[N,C]}),e[39]=N,e[40]=C,e[41]=I):I=e[41];let S;e[42]!==v||e[43]!==I?(S=s.jsxs("div",{className:"flex h-[calc(100vh-8rem)] flex-1 flex-col gap-4 overflow-x-auto p-4",children:[v,I]}),e[42]=v,e[43]=I,e[44]=S):S=e[44];let E;return e[45]!==y||e[46]!==d||e[47]!==S?(E=s.jsxs(J,{breadcrumbs:y,children:[d,S]}),e[45]=y,e[46]=d,e[47]=S,e[48]=E):E=e[48],E}function ee(o){return o[0]}function te(o){return{id:o.id,content:o.content,is_from_current_user:o.is_from_patient,created_at:o.created_at,read_at:o.read_at}}function se(){O.reload({only:["messages"]})}export{ye as default};
