import{c as F,u as P,j as t,H as z,r as G}from"./app-DKMZLzfm.js";import{I as O}from"./input-aT928qqq.js";import{B as U}from"./button-BpuFCFGL.js";import{b as V,c as q,d as J,a as K,C as Q}from"./card-Ct3FmLMH.js";import{a as W,b as X,c as Y,A as Z}from"./app-layout-mDgHwkxe.js";import{M as ee,S as te}from"./message-thread-DvtN3pcT.js";import{r as se}from"./stripe-DEhpSmJl.js";/* empty css            */import"./mapbox-fioGkFd4.js";import"./sheet-COscS31w.js";import"./x-CVwgNE2J.js";import"./index--92RBgGL.js";import"./index-B_ybs1te.js";import"./index-Cns2SMks.js";import"./index-CO8lL1Hs.js";import"./index-DAEGULsz.js";import"./index-CMWG4mbA.js";import"./clock-Br7JvzSP.js";import"./map-pin-6HZ9aDy_.js";import"./message-circle-BH8WnjW2.js";import"./index-BdQq_4o_.js";import"./format-BqGRHkU_.js";import"./isSameDay-IV5ClnVe.js";const ae=5e3,re=[{title:"Dashboard",href:"/dashboard"},{title:"Messages",href:"/chat"},{title:"Conversation",href:"#"}];function De(a){const e=F.c(59),{booking:s,messages:C}=a;let y;e[0]!==C?(y=C===void 0?[]:C,e[0]=C,e[1]=y):y=e[1];const w=y;let S;e[2]===Symbol.for("react.memo_cache_sentinel")?(S={message:""},e[2]=S):S=e[2];const{data:r,setData:D,post:H,processing:l,reset:L}=P(S);let A;e[3]===Symbol.for("react.memo_cache_sentinel")?(A=[],e[3]=A):A=e[3],se.useEffect(oe,A);let I;e[4]!==s.id||e[5]!==r.message||e[6]!==H||e[7]!==L?(I=$=>{$.preventDefault(),r.message.trim()&&H(`/chat/${s.id}`,{onSuccess:()=>{L()}})},e[4]=s.id,e[5]=r.message,e[6]=H,e[7]=L,e[8]=I):I=e[8];const k=I;let E;e[9]!==w?(E=w.map(ie),e[9]=w,e[10]=E):E=e[10];const B=E,R=`Chat - ${s.patient_name}`;let i;e[11]!==R?(i=t.jsx(z,{title:R}),e[11]=R,e[12]=i):i=e[12];let o;e[13]!==s.patient_avatar?(o=t.jsx(W,{src:s.patient_avatar}),e[13]=s.patient_avatar,e[14]=o):o=e[14];let n;e[15]!==s.patient_name?(n=s.patient_name.split(" ").map(le).join("").toUpperCase(),e[15]=s.patient_name,e[16]=n):n=e[16];let m;e[17]!==n?(m=t.jsx(X,{children:n}),e[17]=n,e[18]=m):m=e[18];let c;e[19]!==m||e[20]!==o?(c=t.jsxs(Y,{className:"h-10 w-10",children:[o,m]}),e[19]=m,e[20]=o,e[21]=c):c=e[21];let p;e[22]!==s.patient_name?(p=t.jsx(V,{className:"text-lg",children:s.patient_name}),e[22]=s.patient_name,e[23]=p):p=e[23];let f;e[24]!==s.id?(f=t.jsxs(q,{children:["Booking #",s.id]}),e[24]=s.id,e[25]=f):f=e[25];let d;e[26]!==p||e[27]!==f?(d=t.jsxs("div",{children:[p,f]}),e[26]=p,e[27]=f,e[28]=d):d=e[28];let x;e[29]!==c||e[30]!==d?(x=t.jsx(J,{className:"border-b",children:t.jsxs("div",{className:"flex items-center gap-3",children:[c,d]})}),e[29]=c,e[30]=d,e[31]=x):x=e[31];let h;e[32]!==B?(h=t.jsx(ee,{messages:B,emptyMessage:"No messages yet. Start the conversation!",className:"flex-1"}),e[32]=B,e[33]=h):h=e[33];let u;e[34]!==D?(u=$=>D("message",$.target.value),e[34]=D,e[35]=u):u=e[35];let _;e[36]!==r.message||e[37]!==l||e[38]!==u?(_=t.jsx(O,{value:r.message,onChange:u,placeholder:"Type your message...",disabled:l}),e[36]=r.message,e[37]=l,e[38]=u,e[39]=_):_=e[39];let g;e[40]!==r.message||e[41]!==l?(g=l||!r.message.trim(),e[40]=r.message,e[41]=l,e[42]=g):g=e[42];let M;e[43]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx(te,{className:"h-4 w-4"}),e[43]=M):M=e[43];let j;e[44]!==g?(j=t.jsx(U,{type:"submit",size:"icon",disabled:g,children:M}),e[44]=g,e[45]=j):j=e[45];let v;e[46]!==k||e[47]!==_||e[48]!==j?(v=t.jsx("div",{className:"border-t p-4",children:t.jsxs("form",{onSubmit:k,className:"flex gap-2",children:[_,j]})}),e[46]=k,e[47]=_,e[48]=j,e[49]=v):v=e[49];let b;e[50]!==h||e[51]!==v?(b=t.jsxs(K,{className:"flex flex-1 flex-col p-0",children:[h,v]}),e[50]=h,e[51]=v,e[52]=b):b=e[52];let N;e[53]!==x||e[54]!==b?(N=t.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto p-4",children:t.jsxs(Q,{className:"flex flex-1 flex-col",children:[x,b]})}),e[53]=x,e[54]=b,e[55]=N):N=e[55];let T;return e[56]!==N||e[57]!==i?(T=t.jsxs(Z,{breadcrumbs:re,children:[i,N]}),e[56]=N,e[57]=i,e[58]=T):T=e[58],T}function le(a){return a[0]}function ie(a){return{id:a.id,content:a.message,is_from_current_user:a.sender_type==="provider",created_at:a.created_at,read_at:null}}function oe(){const a=setInterval(ne,ae);return()=>clearInterval(a)}function ne(){G.reload({only:["messages"]})}export{De as default};
