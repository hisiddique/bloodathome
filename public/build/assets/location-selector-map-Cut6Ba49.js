import{c as P,a as C}from"./button-BpuFCFGL.js";import{c as R,j as s,a as $}from"./app-DKMZLzfm.js";import{r as p}from"./stripe-DEhpSmJl.js";import{I as B}from"./input-aT928qqq.js";import{s as D,i as T}from"./google-maps-DaoVeR9E.js";import{r as H,g as V}from"./mapbox-fioGkFd4.js";import{M as O}from"./map-pin-6HZ9aDy_.js";import{L as G}from"./loader-circle-C-jBiGq1.js";const Z=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],ne=P("Map",Z);const q=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],oe=P("Navigation",q),F=p.forwardRef((w,e)=>{const t=R.c(35);let d,c,n,r,f,l,o;t[0]!==w?({className:d,leftIcon:r,rightIcon:o,rightAction:l,helperText:c,inputClassName:n,...f}=w,t[0]=w,t[1]=d,t[2]=c,t[3]=n,t[4]=r,t[5]=f,t[6]=l,t[7]=o):(d=t[1],c=t[2],n=t[3],r=t[4],f=t[5],l=t[6],o=t[7]);let m;t[8]!==d?(m=C("w-full",d),t[8]=d,t[9]=m):m=t[9];let i;t[10]!==r?(i=r&&s.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none",children:r}),t[10]=r,t[11]=i):i=t[11];const g=r&&"pl-10",E=(o||l)&&"pr-10";let k;t[12]!==n||t[13]!==g||t[14]!==E?(k=C(g,E,n),t[12]=n,t[13]=g,t[14]=E,t[15]=k):k=t[15];let x;t[16]!==f||t[17]!==e||t[18]!==k?(x=s.jsx(B,{ref:e,className:k,...f}),t[16]=f,t[17]=e,t[18]=k,t[19]=x):x=t[19];let b;t[20]!==o?(b=o&&s.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none",children:o}),t[20]=o,t[21]=b):b=t[21];let N;t[22]!==l?(N=l&&s.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:l}),t[22]=l,t[23]=N):N=t[23];let h;t[24]!==i||t[25]!==x||t[26]!==b||t[27]!==N?(h=s.jsxs("div",{className:"relative",children:[i,x,b,N]}),t[24]=i,t[25]=x,t[26]=b,t[27]=N,t[28]=h):h=t[28];let v;t[29]!==c?(v=c&&s.jsx("p",{className:"text-xs text-muted-foreground mt-1.5",children:c}),t[29]=c,t[30]=v):v=t[30];let j;return t[31]!==m||t[32]!==v||t[33]!==h?(j=s.jsxs("div",{className:m,children:[h,v]}),t[31]=m,t[32]=v,t[33]=h,t[34]=j):j=t[34],j});F.displayName="IconInput";let A=!1,I=null;function U(w){const e=R.c(7),[t,d]=p.useState(!1),[c,n]=p.useState(null),[r,f]=p.useState(I),l=p.useRef(!1);let o,m;e[0]!==w?(o=()=>{if(!w){n(new Error("Google Maps API key not configured. Please add it in admin settings."));return}if(I){d(!0),f(I);return}l.current||(l.current=!0,A||(D({key:w,version:"weekly"}),A=!0),Promise.all([T("maps"),T("marker"),T("places"),T("geometry")]).then(g=>{const[E,k,x,b]=g;I={Map:E.Map,AdvancedMarkerElement:k.AdvancedMarkerElement,places:x,geometry:b},f(I),d(!0),n(null),l.current=!1}).catch(g=>{console.error("Error loading Google Maps:",g),n(g),d(!1),l.current=!1}))},m=[w],e[0]=w,e[1]=o,e[2]=m):(o=e[1],m=e[2]),p.useEffect(o,m);let i;return e[3]!==t||e[4]!==r||e[5]!==c?(i={isLoaded:t,loadError:c,libraries:r},e[3]=t,e[4]=r,e[5]=c,e[6]=i):i=e[6],i}var J=H();const z=V(J);function ae(w){const e=R.c(12),{center:t,zoom:d,onLocationSelect:c,className:n}=w,r=d===void 0?13:d,{mapProvider:f,googleMapsKey:l,mapboxToken:o}=$().props;if(f==="google"){let i;return e[0]!==t||e[1]!==n||e[2]!==l||e[3]!==c||e[4]!==r?(i=s.jsx(Q,{center:t,zoom:r,onLocationSelect:c,googleMapsKey:l,className:n}),e[0]=t,e[1]=n,e[2]=l,e[3]=c,e[4]=r,e[5]=i):i=e[5],i}let m;return e[6]!==t||e[7]!==n||e[8]!==o||e[9]!==c||e[10]!==r?(m=s.jsx(W,{center:t,zoom:r,onLocationSelect:c,mapboxToken:o,className:n}),e[6]=t,e[7]=n,e[8]=o,e[9]=c,e[10]=r,e[11]=m):m=e[11],m}function Q(w){const e=R.c(29),{center:t,zoom:d,onLocationSelect:c,googleMapsKey:n,className:r}=w,{isLoaded:f,loadError:l,libraries:o}=U(n),m=p.useRef(null),i=p.useRef(null),g=p.useRef(null),[E,k]=p.useState(!1);let x,b;e[0]!==t||e[1]!==f||e[2]!==o||e[3]!==c||e[4]!==d?(x=()=>{if(!(!f||!o||!m.current||i.current))try{const{Map:a,AdvancedMarkerElement:u}=o;i.current=new a(m.current,{center:t,zoom:d,mapId:"BLOODATHOME_LOCATION_SELECTOR",disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0,draggableCursor:"crosshair"});const y=document.createElement("div");y.innerHTML=`
                <div class="flex flex-col items-center">
                    <div class="bg-red-500 border-2 border-red-700 rounded-full p-2 shadow-lg">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
                            <circle cx="12" cy="10" r="3"/>
                        </svg>
                    </div>
                    <div class="w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-red-700 -mt-1"></div>
                </div>
            `,g.current=new u({map:i.current,position:t,content:y,title:"Selected Location"}),i.current.addListener("click",L=>{if(L.latLng&&g.current){const M={lat:L.latLng.lat(),lng:L.latLng.lng()};g.current.position=M,c(M)}}),k(!1)}catch(a){console.error("Error initializing map:",a),k(!0)}},b=[f,o,t,d,c],e[0]=t,e[1]=f,e[2]=o,e[3]=c,e[4]=d,e[5]=x,e[6]=b):(x=e[5],b=e[6]),p.useEffect(x,b);let N,h;if(e[7]!==t?(N=()=>{g.current&&i.current&&(g.current.position=t,i.current.setCenter(t))},h=[t],e[7]=t,e[8]=N,e[9]=h):(N=e[8],h=e[9]),p.useEffect(N,h),l||E||!n){let a;e[10]!==r?(a=C("relative w-full h-96 bg-muted rounded-2xl flex flex-col items-center justify-center p-6",r),e[10]=r,e[11]=a):a=e[11];let u;e[12]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx(O,{className:"w-10 h-10 text-muted-foreground mb-2"}),e[12]=u):u=e[12];const y=n?l?.message||"Map unavailable":"Google Maps API key not configured";let L;e[13]!==y?(L=s.jsx("p",{className:"text-sm text-muted-foreground",children:y}),e[13]=y,e[14]=L):L=e[14];let M;return e[15]!==a||e[16]!==L?(M=s.jsxs("div",{className:a,children:[u,L]}),e[15]=a,e[16]=L,e[17]=M):M=e[17],M}if(!f){let a;e[18]!==r?(a=C("relative w-full h-96 bg-muted rounded-2xl flex items-center justify-center",r),e[18]=r,e[19]=a):a=e[19];let u;e[20]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(G,{className:"w-8 h-8 text-primary animate-spin"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading map..."})]}),e[20]=u):u=e[20];let y;return e[21]!==a?(y=s.jsx("div",{className:a,children:u}),e[21]=a,e[22]=y):y=e[22],y}let v;e[23]!==r?(v=C("relative w-full h-96 rounded-2xl overflow-hidden border border-border",r),e[23]=r,e[24]=v):v=e[24];let j;e[25]===Symbol.for("react.memo_cache_sentinel")?(j=s.jsx("div",{ref:m,className:"absolute inset-0"}),e[25]=j):j=e[25];let S;e[26]===Symbol.for("react.memo_cache_sentinel")?(S=s.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 shadow-lg z-10",children:s.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-200 text-center",children:"Click on the map to select a location"})}),e[26]=S):S=e[26];let _;return e[27]!==v?(_=s.jsxs("div",{className:v,children:[j,S]}),e[27]=v,e[28]=_):_=e[28],_}function W(w){const e=R.c(29),{center:t,zoom:d,onLocationSelect:c,mapboxToken:n,className:r}=w,f=p.useRef(null),l=p.useRef(null),o=p.useRef(null),[m,i]=p.useState(!1),[g,E]=p.useState(!0);let k,x;e[0]!==t.lat||e[1]!==t.lng||e[2]!==n||e[3]!==c||e[4]!==d?(k=()=>{if(!(!n||!f.current||l.current)){try{z.accessToken=n,l.current=new z.Map({container:f.current,style:"mapbox://styles/mapbox/streets-v12",center:[t.lng,t.lat],zoom:d}),l.current.addControl(new z.NavigationControl);const a=document.createElement("div");a.innerHTML=`
                <div class="flex flex-col items-center">
                    <div class="bg-red-500 border-2 border-red-700 rounded-full p-2 shadow-lg">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
                            <circle cx="12" cy="10" r="3"/>
                        </svg>
                    </div>
                    <div class="w-0 h-0 border-l-8 border-r-8 border-t-8 border-transparent border-t-red-700 -mt-1"></div>
                </div>
            `,o.current=new z.Marker({element:a,draggable:!1}).setLngLat([t.lng,t.lat]).addTo(l.current),l.current.on("click",u=>{if(o.current){const y={lat:u.lngLat.lat,lng:u.lngLat.lng};o.current.setLngLat([u.lngLat.lng,u.lngLat.lat]),c(y)}}),l.current.on("load",()=>{E(!1),l.current&&(l.current.getCanvas().style.cursor="crosshair")}),i(!1)}catch(a){console.error("Error initializing Mapbox:",a),i(!0),E(!1)}return()=>{l.current&&(l.current.remove(),l.current=null)}}},x=[n,t.lat,t.lng,d,c],e[0]=t.lat,e[1]=t.lng,e[2]=n,e[3]=c,e[4]=d,e[5]=k,e[6]=x):(k=e[5],x=e[6]),p.useEffect(k,x);let b;e[7]!==t.lat||e[8]!==t.lng?(b=()=>{o.current&&l.current&&(o.current.setLngLat([t.lng,t.lat]),l.current.setCenter([t.lng,t.lat]))},e[7]=t.lat,e[8]=t.lng,e[9]=b):b=e[9];let N;if(e[10]!==t?(N=[t],e[10]=t,e[11]=N):N=e[11],p.useEffect(b,N),m||!n){let a;e[12]!==r?(a=C("relative w-full h-96 bg-muted rounded-2xl flex flex-col items-center justify-center p-6",r),e[12]=r,e[13]=a):a=e[13];let u;e[14]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx(O,{className:"w-10 h-10 text-muted-foreground mb-2"}),e[14]=u):u=e[14];const y=n?"Map unavailable":"Mapbox access token not configured";let L;e[15]!==y?(L=s.jsx("p",{className:"text-sm text-muted-foreground",children:y}),e[15]=y,e[16]=L):L=e[16];let M;return e[17]!==a||e[18]!==L?(M=s.jsxs("div",{className:a,children:[u,L]}),e[17]=a,e[18]=L,e[19]=M):M=e[19],M}let h;e[20]!==r?(h=C("relative w-full h-96 rounded-2xl overflow-hidden border border-border",r),e[20]=r,e[21]=h):h=e[21];let v;e[22]===Symbol.for("react.memo_cache_sentinel")?(v=s.jsx("div",{ref:f,className:"absolute inset-0"}),e[22]=v):v=e[22];let j;e[23]!==g?(j=g&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted/50 backdrop-blur-sm",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(G,{className:"w-8 h-8 text-primary animate-spin"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading map..."})]})}),e[23]=g,e[24]=j):j=e[24];let S;e[25]===Symbol.for("react.memo_cache_sentinel")?(S=s.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border border-gray-200 dark:border-gray-700 rounded-lg px-4 py-2 shadow-lg z-10",children:s.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-200 text-center",children:"Click on the map to select a location"})}),e[25]=S):S=e[25];let _;return e[26]!==h||e[27]!==j?(_=s.jsxs("div",{className:h,children:[v,j,S]}),e[26]=h,e[27]=j,e[28]=_):_=e[28],_}export{F as I,ae as L,ne as M,oe as N,z as m,U as u};
