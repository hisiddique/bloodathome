import{c as $,u as F,j as t,H as z,r as G}from"./app-Bmo3up5q.js";import{I as O}from"./input-wNfwdC4B.js";import{B as U}from"./button-DzSWANc3.js";import{b as V,c as q,d as J,a as K,C as Q}from"./card-9lfhvvu9.js";import{A as W,a as X,b as Y}from"./app-sidebar-header-DQfw6vPa.js";import{M as Z}from"./message-thread-CYVST463.js";import{P as ee}from"./provider-layout-BgtZdBlN.js";import{r as te}from"./stripe-DEhpSmJl.js";import{S as se}from"./send-BDGcIbj8.js";/* empty css            */import"./mapbox-fioGkFd4.js";import"./createLucideIcon-DVqpq5-V.js";import"./sheet-DYeZ4Q_f.js";import"./index-Bb7u4XXV.js";import"./x-B1iQPaVG.js";import"./index-9OkN_xwD.js";import"./index-B3L8qX5R.js";import"./index-BtbDWhsc.js";import"./index-BJLn3sgI.js";import"./settings-B1xDw0BD.js";import"./chevron-right-CmxyfaW7.js";import"./index-BdQq_4o_.js";import"./format-Dx8HDyBA.js";import"./isSameDay-C7OnRSQZ.js";import"./calendar-Chh4H_-Q.js";import"./clock-BUDsSYec.js";import"./map-pin-CUMyF97U.js";import"./message-circle-C-5rTX30.js";import"./user-DwijRDrY.js";const ae=5e3,re=[{title:"Dashboard",href:"/provider/dashboard"},{title:"Messages",href:"/provider/chat"},{title:"Conversation",href:"#"}];function Re(a){const e=$.c(59),{booking:s,messages:C}=a;let y;e[0]!==C?(y=C===void 0?[]:C,e[0]=C,e[1]=y):y=e[1];const w=y;let S;e[2]===Symbol.for("react.memo_cache_sentinel")?(S={message:""},e[2]=S):S=e[2];const{data:r,setData:D,post:H,processing:i,reset:L}=F(S);let I;e[3]===Symbol.for("react.memo_cache_sentinel")?(I=[],e[3]=I):I=e[3],te.useEffect(oe,I);let A;e[4]!==s.id||e[5]!==r.message||e[6]!==H||e[7]!==L?(A=R=>{R.preventDefault(),r.message.trim()&&H(`/provider/chat/${s.id}`,{onSuccess:()=>{L()}})},e[4]=s.id,e[5]=r.message,e[6]=H,e[7]=L,e[8]=A):A=e[8];const P=A;let E;e[9]!==w?(E=w.map(le),e[9]=w,e[10]=E):E=e[10];const k=E,B=`Chat - ${s.patient_name}`;let l;e[11]!==B?(l=t.jsx(z,{title:B}),e[11]=B,e[12]=l):l=e[12];let o;e[13]!==s.patient_avatar?(o=t.jsx(W,{src:s.patient_avatar}),e[13]=s.patient_avatar,e[14]=o):o=e[14];let m;e[15]!==s.patient_name?(m=s.patient_name.split(" ").map(ie).join("").toUpperCase(),e[15]=s.patient_name,e[16]=m):m=e[16];let n;e[17]!==m?(n=t.jsx(X,{children:m}),e[17]=m,e[18]=n):n=e[18];let c;e[19]!==n||e[20]!==o?(c=t.jsxs(Y,{className:"h-10 w-10",children:[o,n]}),e[19]=n,e[20]=o,e[21]=c):c=e[21];let p;e[22]!==s.patient_name?(p=t.jsx(V,{className:"text-lg",children:s.patient_name}),e[22]=s.patient_name,e[23]=p):p=e[23];let f;e[24]!==s.id?(f=t.jsxs(q,{children:["Booking #",s.id]}),e[24]=s.id,e[25]=f):f=e[25];let d;e[26]!==p||e[27]!==f?(d=t.jsxs("div",{children:[p,f]}),e[26]=p,e[27]=f,e[28]=d):d=e[28];let x;e[29]!==c||e[30]!==d?(x=t.jsx(J,{className:"border-b",children:t.jsxs("div",{className:"flex items-center gap-3",children:[c,d]})}),e[29]=c,e[30]=d,e[31]=x):x=e[31];let h;e[32]!==k?(h=t.jsx(Z,{messages:k,emptyMessage:"No messages yet. Start the conversation!",className:"flex-1"}),e[32]=k,e[33]=h):h=e[33];let u;e[34]!==D?(u=R=>D("message",R.target.value),e[34]=D,e[35]=u):u=e[35];let _;e[36]!==r.message||e[37]!==i||e[38]!==u?(_=t.jsx(O,{value:r.message,onChange:u,placeholder:"Type your message...",disabled:i}),e[36]=r.message,e[37]=i,e[38]=u,e[39]=_):_=e[39];let g;e[40]!==r.message||e[41]!==i?(g=i||!r.message.trim(),e[40]=r.message,e[41]=i,e[42]=g):g=e[42];let M;e[43]===Symbol.for("react.memo_cache_sentinel")?(M=t.jsx(se,{className:"h-4 w-4"}),e[43]=M):M=e[43];let v;e[44]!==g?(v=t.jsx(U,{type:"submit",size:"icon",disabled:g,children:M}),e[44]=g,e[45]=v):v=e[45];let j;e[46]!==P||e[47]!==_||e[48]!==v?(j=t.jsx("div",{className:"border-t p-4",children:t.jsxs("form",{onSubmit:P,className:"flex gap-2",children:[_,v]})}),e[46]=P,e[47]=_,e[48]=v,e[49]=j):j=e[49];let b;e[50]!==h||e[51]!==j?(b=t.jsxs(K,{className:"flex flex-1 flex-col p-0",children:[h,j]}),e[50]=h,e[51]=j,e[52]=b):b=e[52];let N;e[53]!==x||e[54]!==b?(N=t.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto p-4",children:t.jsxs(Q,{className:"flex flex-1 flex-col",children:[x,b]})}),e[53]=x,e[54]=b,e[55]=N):N=e[55];let T;return e[56]!==N||e[57]!==l?(T=t.jsxs(ee,{breadcrumbs:re,children:[l,N]}),e[56]=N,e[57]=l,e[58]=T):T=e[58],T}function ie(a){return a[0]}function le(a){return{id:a.id,content:a.message,is_from_current_user:a.sender_type==="provider",created_at:a.created_at,read_at:null}}function oe(){const a=setInterval(me,ae);return()=>clearInterval(a)}function me(){G.reload({only:["messages"]})}export{Re as default};
