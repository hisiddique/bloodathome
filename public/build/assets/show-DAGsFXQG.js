import{c as P,j as s,F as B,H as F,r as R}from"./app-Bmo3up5q.js";import{b as O,c as q,C as H,d as D}from"./card-9lfhvvu9.js";import{A as G,a as U,b as V}from"./app-sidebar-header-DQfw6vPa.js";import{M as J}from"./message-thread-CYVST463.js";import{B as K}from"./button-DzSWANc3.js";import{I as Q}from"./input-wNfwdC4B.js";import{S as W}from"./send-BDGcIbj8.js";import{P as X}from"./patient-layout-Bp_1--oo.js";import{r as L}from"./stripe-DEhpSmJl.js";/* empty css            */import"./mapbox-fioGkFd4.js";import"./createLucideIcon-DVqpq5-V.js";import"./sheet-DYeZ4Q_f.js";import"./index-Bb7u4XXV.js";import"./x-B1iQPaVG.js";import"./index-9OkN_xwD.js";import"./index-B3L8qX5R.js";import"./index-BtbDWhsc.js";import"./index-BJLn3sgI.js";import"./settings-B1xDw0BD.js";import"./chevron-right-CmxyfaW7.js";import"./index-BdQq_4o_.js";import"./format-Dx8HDyBA.js";import"./isSameDay-C7OnRSQZ.js";import"./app-sidebar-layout-CEQSba7d.js";function Y(i){const e=P.c(7),{action:t,placeholder:n,disabled:m}=i,c=n===void 0?"Type your message...":n,l=m===void 0?!1:m;let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a={preserveScroll:!0},e[0]=a):a=e[0];let o;e[1]!==l||e[2]!==c?(o=y=>{const{processing:p}=y;return s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Q,{name:"content",placeholder:c,required:!0,disabled:p||l,autoComplete:"off"}),s.jsx(K,{type:"submit",disabled:p||l,size:"icon",children:s.jsx(W,{className:"size-4"})})]})},e[1]=l,e[2]=c,e[3]=o):o=e[3];let r;return e[4]!==t||e[5]!==o?(r=s.jsx("div",{className:"border-t p-4",children:s.jsx(B,{action:t,method:"post",resetOnSuccess:!0,options:a,id:"message-form",children:o})}),e[4]=t,e[5]=o,e[6]=r):r=e[6],r}const Z=5e3;function ke(i){const e=P.c(49),{conversation:t,messages:n}=i;let m;e[0]!==n?(m=n===void 0?[]:n,e[0]=n,e[1]=m):m=e[1];const c=m,[l]=L.useState(!0);let a;e[2]===Symbol.for("react.memo_cache_sentinel")?(a={title:"Messages",href:"/patient/chat"},e[2]=a):a=e[2];const o=`/patient/chat/${t.id}`;let r;e[3]!==t.phlebotomist_name||e[4]!==o?(r=[a,{title:t.phlebotomist_name,href:o}],e[3]=t.phlebotomist_name,e[4]=o,e[5]=r):r=e[5];const y=r;let p,A;e[6]!==l?(p=()=>{if(!l)return;const z=setInterval(se,Z);return()=>clearInterval(z)},A=[l],e[6]=l,e[7]=p,e[8]=A):(p=e[7],A=e[8]),L.useEffect(p,A);let k;e[9]!==c?(k=c.map(te),e[9]=c,e[10]=k):k=e[10];const M=k,T=`Chat with ${t.phlebotomist_name}`;let d;e[11]!==T?(d=s.jsx(F,{title:T}),e[11]=T,e[12]=d):d=e[12];const $=t.phlebotomist_image||"/placeholder.svg";let f;e[13]!==t.phlebotomist_name||e[14]!==$?(f=s.jsx(G,{src:$,alt:t.phlebotomist_name}),e[13]=t.phlebotomist_name,e[14]=$,e[15]=f):f=e[15];let h;e[16]!==t.phlebotomist_name?(h=t.phlebotomist_name.split(" ").map(ee).join("").toUpperCase().slice(0,2),e[16]=t.phlebotomist_name,e[17]=h):h=e[17];let x;e[18]!==h?(x=s.jsx(U,{children:h}),e[18]=h,e[19]=x):x=e[19];let u;e[20]!==f||e[21]!==x?(u=s.jsxs(V,{className:"size-12",children:[f,x]}),e[20]=f,e[21]=x,e[22]=u):u=e[22];let _;e[23]!==t.phlebotomist_name?(_=s.jsx(O,{className:"text-lg",children:t.phlebotomist_name}),e[23]=t.phlebotomist_name,e[24]=_):_=e[24];let b;e[25]!==t.booking_id?(b=t.booking_id.slice(0,8),e[25]=t.booking_id,e[26]=b):b=e[26];let j;e[27]!==b?(j=s.jsxs(q,{children:["Booking #",b]}),e[27]=b,e[28]=j):j=e[28];let g;e[29]!==_||e[30]!==j?(g=s.jsxs("div",{children:[_,j]}),e[29]=_,e[30]=j,e[31]=g):g=e[31];let v;e[32]!==u||e[33]!==g?(v=s.jsx(H,{className:"mb-4",children:s.jsx(D,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[u,g]})})}),e[32]=u,e[33]=g,e[34]=v):v=e[34];let N;e[35]!==M?(N=s.jsx(J,{messages:M,className:"flex-1"}),e[35]=M,e[36]=N):N=e[36];const w=`/patient/chat/${t.id}/messages`;let C;e[37]!==w?(C=s.jsx(Y,{action:w}),e[37]=w,e[38]=C):C=e[38];let I;e[39]!==N||e[40]!==C?(I=s.jsxs(H,{className:"flex flex-1 flex-col overflow-hidden",children:[N,C]}),e[39]=N,e[40]=C,e[41]=I):I=e[41];let S;e[42]!==v||e[43]!==I?(S=s.jsxs("div",{className:"mx-auto flex h-[calc(100vh-8rem)] max-w-4xl flex-col p-6",children:[v,I]}),e[42]=v,e[43]=I,e[44]=S):S=e[44];let E;return e[45]!==y||e[46]!==d||e[47]!==S?(E=s.jsxs(X,{breadcrumbs:y,children:[d,S]}),e[45]=y,e[46]=d,e[47]=S,e[48]=E):E=e[48],E}function ee(i){return i[0]}function te(i){return{id:i.id,content:i.content,is_from_current_user:i.is_from_patient,created_at:i.created_at,read_at:i.read_at}}function se(){R.reload({only:["messages"]})}export{ke as default};
