import{c as Q,j as t,r as Oe,a as at,b as lt,H as Fe}from"./app-Bmo3up5q.js";import{r as S}from"./stripe-DEhpSmJl.js";import{u as ot,P as nt}from"./public-layout-DavRu2rv.js";import{B as Ye}from"./header-BUHtjhN6.js";import{C as Ve}from"./chat-button-AgXEZkfE.js";import{C as Le}from"./confirm-button-cc-7lyic.js";import{B as it}from"./chat-iG4mGQ2c.js";import{M as ct}from"./message-circle-C-5rTX30.js";import{a as dt,c as $}from"./createLucideIcon-DVqpq5-V.js";import{C as Ge}from"./calendar-Chh4H_-Q.js";import{C as mt}from"./clock-BUDsSYec.js";import{f as Me}from"./format-Dx8HDyBA.js";import{t as Be}from"./index-CsYnJTPh.js";import{M as st}from"./map-pin-CUMyF97U.js";import{N as ut}from"./navigation-DSG-f7Iq.js";import{L as xt}from"./location-map-BwqwAlvq.js";import{a as ft,i as pt}from"./isSameDay-C7OnRSQZ.js";import{P as gt}from"./card-B2dzyLaf.js";import{B as Ie}from"./button-DzSWANc3.js";import{C as ze}from"./checkbox-ERwv1fC2.js";import{S as Je,a as Ke,b as We,c as Xe,d as Re}from"./select-CFPlT4kR.js";import{X as ht}from"./x-B1iQPaVG.js";import{C as Qe}from"./credit-card-BNVHNu_L.js";import{C as rt}from"./check-D0gE3ZqX.js";import{U as bt}from"./user-DwijRDrY.js";import{L as Ze}from"./lock-DD1ZaMHz.js";/* empty css            */import"./mapbox-fioGkFd4.js";import"./sheet-DYeZ4Q_f.js";import"./index-Bb7u4XXV.js";import"./search-Ch72ipEu.js";import"./chevron-left-DDE2JrwW.js";import"./input-wNfwdC4B.js";import"./send-BDGcIbj8.js";import"./spinner-78-O8EH7.js";import"./loader-circle-DNWwauI4.js";import"./index-b6iZoh8X.js";import"./index-BtbDWhsc.js";import"./index-BdQq_4o_.js";import"./index-9OkN_xwD.js";import"./index-B3L8qX5R.js";import"./chevron-down-B8qUHuRM.js";const jt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],yt=dt("CircleCheck",jt);function Nt(h){const e=Q.c(40),{date:o,timeSlot:d,bookingId:c,phlebotomist:r,onDone:n}=h,[a,l]=S.useState(!1);let j;e[0]!==n?(j=()=>{n?n():Oe.visit("/")},e[0]=n,e[1]=j):j=e[1];const m=j;let f,s,y;e[2]===Symbol.for("react.memo_cache_sentinel")?(f=t.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mb-6",children:t.jsx(yt,{className:"w-14 h-14 text-green-600"})}),s=t.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2 text-center",children:"Booking Confirmed!"}),y=t.jsx("p",{className:"text-muted-foreground text-center mb-8 max-w-xs",children:"Your appointment has been scheduled successfully. We'll send you a reminder before your visit."}),e[2]=f,e[3]=s,e[4]=y):(f=e[2],s=e[3],y=e[4]);let u;e[5]!==r?(u=r&&t.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-4 border-b border-border",children:[t.jsx("img",{src:r.image,alt:r.name,className:"w-12 h-12 rounded-full object-cover"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-foreground",children:r.name}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Your Phlebotomist"})]})]}),e[5]=r,e[6]=u):u=e[6];let x;e[7]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx(Ge,{className:"w-5 h-5 text-primary"}),e[7]=x):x=e[7];let N;e[8]!==o?(N=Me(o,"EEE, MMM d"),e[8]=o,e[9]=N):N=e[9];let C;e[10]!==N?(C=t.jsxs("div",{className:"flex items-center gap-3",children:[x,t.jsx("span",{className:"font-medium text-foreground",children:N})]}),e[10]=N,e[11]=C):C=e[11];let P;e[12]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx(mt,{className:"w-5 h-5 text-primary"}),e[12]=P):P=e[12];let w;e[13]!==d?(w=t.jsxs("div",{className:"flex items-center gap-3",children:[P,t.jsx("span",{className:"font-medium text-foreground",children:d})]}),e[13]=d,e[14]=w):w=e[14];let k;e[15]!==w||e[16]!==C?(k=t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[C,w]}),e[15]=w,e[16]=C,e[17]=k):k=e[17];let i;e[18]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsx("div",{className:"text-sm text-muted-foreground",children:"Blood draw appointment at your home"}),e[18]=i):i=e[18];let p;e[19]!==k||e[20]!==u?(p=t.jsxs("div",{className:"bg-card rounded-3xl p-6 w-full border border-border mb-8",children:[u,k,i]}),e[19]=k,e[20]=u,e[21]=p):p=e[21];let v;e[22]!==c||e[23]!==r?(v=c&&r&&t.jsxs("button",{onClick:()=>l(!0),className:"w-full flex items-center justify-center gap-2 py-4 bg-primary/10 text-primary rounded-2xl font-semibold hover:bg-primary/20 transition-colors",children:[t.jsx(ct,{className:"w-5 h-5"}),"Chat with ",r.name]}),e[22]=c,e[23]=r,e[24]=v):v=e[24];let E;e[25]!==m?(E=t.jsx(Le,{onClick:m,children:"Done"}),e[25]=m,e[26]=E):E=e[26];let D;e[27]!==v||e[28]!==E?(D=t.jsxs("div",{className:"w-full space-y-3",children:[v,E]}),e[27]=v,e[28]=E,e[29]=D):D=e[29];let _;e[30]!==p||e[31]!==D?(_=t.jsxs("div",{className:"flex flex-col h-full items-center justify-center px-6 animate-fade-in",children:[f,s,y,p,D]}),e[30]=p,e[31]=D,e[32]=_):_=e[32];let g;e[33]!==c||e[34]!==r||e[35]!==a?(g=a&&c&&r&&t.jsx(it,{bookingId:c,phlebotomistName:r.name,phlebotomistImage:r.image,onClose:()=>l(!1)}),e[33]=c,e[34]=r,e[35]=a,e[36]=g):g=e[36];let b;return e[37]!==_||e[38]!==g?(b=t.jsxs(t.Fragment,{children:[_,g]}),e[37]=_,e[38]=g,e[39]=b):b=e[39],b}function vt(h){const e=Q.c(21),{value:o,onChange:d,onUseLocation:c,isLocating:r}=h;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(st,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e[0]=n):n=e[0];let a;e[1]!==d?(a=C=>d(C.target.value),e[1]=d,e[2]=a):a=e[2];let l;e[3]!==a||e[4]!==o?(l=t.jsxs("div",{className:"relative",children:[n,t.jsx("input",{type:"text",value:o,onChange:a,placeholder:"Enter your home address",className:"w-full pl-12 pr-4 py-4 bg-card border border-border rounded-2xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"})]}),e[3]=a,e[4]=o,e[5]=l):l=e[5];const j=r&&"opacity-70 cursor-wait";let m;e[6]!==j?(m=$("w-full flex items-center justify-center gap-2 py-4 rounded-2xl font-medium transition-all","bg-foreground text-background hover:opacity-90",j),e[6]=j,e[7]=m):m=e[7];const f=r&&"animate-pulse";let s;e[8]!==f?(s=$("w-5 h-5",f),e[8]=f,e[9]=s):s=e[9];let y;e[10]!==s?(y=t.jsx(ut,{className:s}),e[10]=s,e[11]=y):y=e[11];const u=r?"Getting location...":"Enable location";let x;e[12]!==r||e[13]!==c||e[14]!==m||e[15]!==y||e[16]!==u?(x=t.jsxs("button",{onClick:c,disabled:r,className:m,children:[y,u]}),e[12]=r,e[13]=c,e[14]=m,e[15]=y,e[16]=u,e[17]=x):x=e[17];let N;return e[18]!==x||e[19]!==l?(N=t.jsxs("div",{className:"space-y-3",children:[l,x]}),e[18]=x,e[19]=l,e[20]=N):N=e[20],N}function St(h){const e=Q.c(3),{selectedDate:o,onDateSelect:d}=h;let c;if(e[0]!==d||e[1]!==o){const r=new Date,n=Array.from({length:14},(a,l)=>ft(r,l));c=t.jsx("div",{className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2 px-1",children:n.map(a=>{const l=pt(a,o);return t.jsxs("button",{onClick:()=>d(a),className:$("flex flex-col items-center justify-center min-w-[72px] h-[72px] rounded-full transition-all duration-200","border-2 flex-shrink-0",l?"bg-accent border-primary":"bg-card border-border hover:border-primary/50"),children:[t.jsx("span",{className:$("text-xs font-medium",l?"text-foreground":"text-muted-foreground"),children:Me(a,"MMM dd")}),t.jsx("span",{className:$("text-sm font-semibold","text-foreground"),children:Me(a,"EEE")})]},a.toISOString())})}),e[0]=d,e[1]=o,e[2]=c}else c=e[2];return c}function Ct(h){const e=Q.c(4),{selected:o,onSelect:d}=h;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=[{value:"morning",label:"Morning"},{value:"afternoon",label:"Afternoon"},{value:"evening",label:"Evening"}],e[0]=c):c=e[0];const r=c;let n;return e[1]!==d||e[2]!==o?(n=t.jsx("div",{className:"flex gap-3 justify-center",children:r.map(a=>t.jsx("button",{onClick:()=>d(a.value),className:$("px-6 py-3 rounded-full text-sm font-medium transition-all duration-200",o===a.value?"bg-primary text-primary-foreground":"bg-card border border-border text-foreground hover:border-primary/50"),children:a.label},a.value))}),e[1]=d,e[2]=o,e[3]=n):n=e[3],n}const wt=h=>{const e=[];let o,d;switch(h){case"morning":o=7,d=12;break;case"afternoon":o=12,d=17;break;case"evening":o=17,d=20;break}for(let c=o;c<d;c++)for(let r=0;r<60;r+=20){const n=`${c.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`,a=r+20,l=a>=60?c+1:c,j=a>=60?a-60:a,m=`${l.toString().padStart(2,"0")}:${j.toString().padStart(2,"0")}`;e.push(`${n} - ${m}`)}return e};function kt(h){const e=Q.c(11),{timeOfDay:o,selectedSlot:d,onSlotSelect:c}=h;let r,n;if(e[0]!==c||e[1]!==d||e[2]!==o){const l=wt(o);r="grid grid-cols-3 gap-3 animate-fade-in";let j;e[5]!==c||e[6]!==d?(j=m=>t.jsx("button",{onClick:()=>c(m),className:$("py-4 px-2 rounded-2xl text-sm font-medium transition-all duration-200","border",d===m?"bg-primary border-primary text-primary-foreground":"bg-card border-border text-foreground hover:border-primary/50 hover:bg-accent/30"),children:m},m),e[5]=c,e[6]=d,e[7]=j):j=e[7],n=l.map(j),e[0]=c,e[1]=d,e[2]=o,e[3]=r,e[4]=n}else r=e[3],n=e[4];let a;return e[8]!==r||e[9]!==n?(a=t.jsx("div",{className:r,children:n}),e[8]=r,e[9]=n,e[10]=a):a=e[10],a}function _t(h){const e=Q.c(51),{onContinue:o,onBack:d,standalone:c}=h,r=c===void 0?!0:c,{mapboxToken:n}=at().props,[a,l]=S.useState(""),[j,m]=S.useState(!1);let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f=[-1.1581,52.9548],e[0]=f):f=e[0];const[s,y]=S.useState(f);let u;e[1]===Symbol.for("react.memo_cache_sentinel")?(u=new Date,e[1]=u):u=e[1];const[x,N]=S.useState(u),[C,P]=S.useState("morning"),[w,k]=S.useState(null);let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=()=>{m(!0),"geolocation"in navigator?navigator.geolocation.getCurrentPosition(K=>{y([K.coords.longitude,K.coords.latitude]),l("Current Location"),m(!1),Be.success("Location found",{description:"Finding phlebotomists near you"})},K=>{console.error("Geolocation error:",K),m(!1),Be.error("Location access denied",{description:"Please enter your address manually"})}):(m(!1),Be.error("Location not supported",{description:"Please enter your address manually"}))},e[2]=i):i=e[2];const p=i;let v;e[3]!==a||e[4]!==o||e[5]!==x||e[6]!==w?(v=()=>{a&&w&&o(a,x,w)},e[3]=a,e[4]=o,e[5]=x,e[6]=w,e[7]=v):v=e[7];const E=v;let D;e[8]!==s?(D=[{id:"user",coordinates:s,label:"Your location"}],e[8]=s,e[9]=D):D=e[9];const _=D,g=r?"px-4":"";let b;e[10]!==d?(b=t.jsx(Ye,{title:"Book Your Appointment",onBack:d}),e[10]=d,e[11]=b):b=e[11];let M;e[12]!==g||e[13]!==b?(M=t.jsx("div",{className:g,children:b}),e[12]=g,e[13]=b,e[14]=M):M=e[14];const A=r?"px-4 space-y-6":"space-y-6",R=n||"";let T;e[15]!==_||e[16]!==R||e[17]!==s?(T=t.jsx(xt,{center:s,zoom:13,markers:_,mapboxToken:R}),e[15]=_,e[16]=R,e[17]=s,e[18]=T):T=e[18];let I;e[19]!==a||e[20]!==j?(I=t.jsx(vt,{value:a,onChange:l,onUseLocation:p,isLocating:j}),e[19]=a,e[20]=j,e[21]=I):I=e[21];let L;e[22]!==x?(L=t.jsx("div",{className:"space-y-3",children:t.jsx(St,{selectedDate:x,onDateSelect:N})}),e[22]=x,e[23]=L):L=e[23];let O;e[24]!==C?(O=t.jsx(Ct,{selected:C,onSelect:P}),e[24]=C,e[25]=O):O=e[25];let F;e[26]!==w||e[27]!==C?(F=t.jsx(kt,{timeOfDay:C,selectedSlot:w,onSlotSelect:k}),e[26]=w,e[27]=C,e[28]=F):F=e[28];let Y;e[29]!==A||e[30]!==T||e[31]!==I||e[32]!==L||e[33]!==O||e[34]!==F?(Y=t.jsxs("div",{className:A,children:[T,I,L,O,F]}),e[29]=A,e[30]=T,e[31]=I,e[32]=L,e[33]=O,e[34]=F,e[35]=Y):Y=e[35];const W=r?"fixed bottom-0 left-0 right-0 lg:max-w-2xl":"mt-6";let V;e[36]!==W?(V=$("p-4 bg-background border-t border-border",W),e[36]=W,e[37]=V):V=e[37];const X=!a||!w;let q;e[38]!==E||e[39]!==X?(q=t.jsx(Le,{onClick:E,disabled:X,children:"Continue"}),e[38]=E,e[39]=X,e[40]=q):q=e[40];let U;e[41]!==V||e[42]!==q?(U=t.jsx("div",{className:V,children:q}),e[41]=V,e[42]=q,e[43]=U):U=e[43];let H;e[44]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx(Ve,{}),e[44]=H):H=e[44];let z;e[45]!==Y||e[46]!==U||e[47]!==M?(z=t.jsxs(t.Fragment,{children:[M,Y,U,H]}),e[45]=Y,e[46]=U,e[47]=M,e[48]=z):z=e[48];const G=z;if(!r)return G;let J;return e[49]!==G?(J=t.jsx("div",{className:"min-h-screen bg-background pb-32",children:G}),e[49]=G,e[50]=J):J=e[50],J}const et=[{id:"1",name:"Dr. Adeel Khan",image:"https://images.unsplash.com/photo-1612349317150-e413f6a5b16d?w=200&h=200&fit=crop&crop=face",rating:4.9,distance:"2.4 miles",price:60,available:!0,experience:"8 years"},{id:"2",name:"Sarah Mitchell",image:"https://images.unsplash.com/photo-1559839734-2b71ea197ec2?w=200&h=200&fit=crop&crop=face",rating:4.8,distance:"3.1 miles",price:55,available:!0,experience:"5 years"},{id:"3",name:"James Wilson",image:"https://images.unsplash.com/photo-1622253692010-333f2da6031d?w=200&h=200&fit=crop&crop=face",rating:4.7,distance:"4.8 miles",price:50,available:!1,experience:"6 years"},{id:"4",name:"Dr. Emily Chen",image:"https://images.unsplash.com/photo-1594824476967-48c8b964273f?w=200&h=200&fit=crop&crop=face",rating:4.9,distance:"5.2 miles",price:65,available:!0,experience:"10 years"},{id:"5",name:"Michael Roberts",image:"https://images.unsplash.com/photo-1537368910025-700350fe46c7?w=200&h=200&fit=crop&crop=face",rating:4.6,distance:"6.0 miles",price:45,available:!0,experience:"4 years"}];function Pt(h){const e=Q.c(45),{date:o,timeSlot:d,onContinue:c,onBack:r,standalone:n}=h,a=n===void 0?!0:n,[l,j]=S.useState(null),m=Dt;let f;e[0]!==c||e[1]!==l?(f=()=>{l&&c(l)},e[0]=c,e[1]=l,e[2]=f):f=e[2];const s=f,y=a?"px-4":"";let u;e[3]!==r?(u=t.jsx(Ye,{title:"Choose a Phlebotomist",onBack:r}),e[3]=r,e[4]=u):u=e[4];let x;e[5]!==y||e[6]!==u?(x=t.jsx("div",{className:y,children:u}),e[5]=y,e[6]=u,e[7]=x):x=e[7];const N=a?"px-4 space-y-4":"space-y-4";let C;e[8]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Your appointment"}),e[8]=C):C=e[8];let P;e[9]!==o?(P=Me(o,"EEEE, MMMM d, yyyy"),e[9]=o,e[10]=P):P=e[10];let w;e[11]!==P||e[12]!==d?(w=t.jsxs("div",{className:"bg-accent/50 rounded-2xl p-4",children:[C,t.jsxs("p",{className:"text-foreground font-medium",children:[P," at ",d]})]}),e[11]=P,e[12]=d,e[13]=w):w=e[13];let k;e[14]===Symbol.for("react.memo_cache_sentinel")?(k=t.jsxs("h2",{className:"text-sm font-medium text-muted-foreground",children:[et.length," phlebotomists nearby"]}),e[14]=k):k=e[14];let i;e[15]!==l?.id?(i=et.map(F=>t.jsx(gt,{phlebotomist:F,isSelected:l?.id===F.id,onSelect:()=>j(F),onViewProfile:()=>m(F)},F.id)),e[15]=l?.id,e[16]=i):i=e[16];let p;e[17]!==i?(p=t.jsxs("div",{className:"space-y-3",children:[k,i]}),e[17]=i,e[18]=p):p=e[18];let v;e[19]!==p||e[20]!==N||e[21]!==w?(v=t.jsxs("div",{className:N,children:[w,p]}),e[19]=p,e[20]=N,e[21]=w,e[22]=v):v=e[22];const E=a?"fixed bottom-0 left-0 right-0 lg:max-w-2xl":"mt-6";let D;e[23]!==E?(D=$("p-4 bg-background border-t border-border",E),e[23]=E,e[24]=D):D=e[24];let _;e[25]!==r||e[26]!==a?(_=!a&&t.jsx(Ie,{variant:"outline",onClick:r,className:"w-full lg:w-auto lg:min-w-[120px] py-4 h-auto rounded-2xl",children:"Back"}),e[25]=r,e[26]=a,e[27]=_):_=e[27];const g=!l,b=l?.name||"selection";let M;e[28]!==s||e[29]!==g||e[30]!==b?(M=t.jsxs(Le,{onClick:s,disabled:g,children:["Continue with ",b]}),e[28]=s,e[29]=g,e[30]=b,e[31]=M):M=e[31];let A;e[32]!==_||e[33]!==M?(A=t.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[_,M]}),e[32]=_,e[33]=M,e[34]=A):A=e[34];let R;e[35]!==D||e[36]!==A?(R=t.jsx("div",{className:D,children:A}),e[35]=D,e[36]=A,e[37]=R):R=e[37];let T;e[38]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx(Ve,{}),e[38]=T):T=e[38];let I;e[39]!==v||e[40]!==R||e[41]!==x?(I=t.jsxs(t.Fragment,{children:[x,v,R,T]}),e[39]=v,e[40]=R,e[41]=x,e[42]=I):I=e[42];const L=I;if(!a)return L;let O;return e[43]!==L?(O=t.jsx("div",{className:"min-h-screen bg-background pb-32",children:L}),e[43]=L,e[44]=O):O=e[44],O}function Dt(h){Be.info(h.name,{description:`${h.experience} experience - Rating: ${h.rating}/5`})}function Et({date:h,timeSlot:e,isUnder16:o,onContinue:d,onBack:c,standalone:r=!0,userData:n=null,userAddresses:a=[]}){const[l,j]=S.useState({name:"",email:"",address1:"",address2:"",city:"London",postCode:"",phone:"",notes:"",guardianName:"",patientAge:"",guardianConfirmed:!1}),[m,f]=S.useState(""),[s,y]=S.useState(!1);S.useEffect(()=>{if(n){j(p=>({...p,name:n.name||p.name,email:n.email||p.email,phone:n.phone||p.phone}));const i=a.find(p=>p.is_default);i&&(f(i.id),u(i.id))}},[n,a]);const u=i=>{if(i==="new"){f("new"),j(v=>({...v,address1:"",address2:"",city:"London",postCode:""}));return}const p=a.find(v=>v.id===i);p&&(f(i),j(v=>({...v,address1:p.address_line1,address2:p.address_line2||"",city:p.town_city,postCode:p.postcode})))},x=(i,p)=>{j(v=>({...v,[i]:p}))},N=l.name.trim()&&l.email.trim()&&l.address1.trim()&&l.city.trim()&&l.postCode.trim()&&l.phone.trim(),C=o?l.guardianName?.trim()&&l.patientAge&&l.guardianConfirmed:!0,P=N&&C,w=()=>{P&&d(l)},k=t.jsxs(t.Fragment,{children:[t.jsx("div",{className:r?"px-4":"",children:t.jsx(Ye,{title:"Patient Details",onBack:c})}),t.jsxs("div",{className:r?"px-4 space-y-6":"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Selected Dates/Times"}),t.jsxs("div",{className:"flex items-center gap-2 p-3 bg-card border border-border rounded-xl",children:[t.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-primary rounded-lg",children:t.jsx(Ge,{className:"w-5 h-5 text-primary-foreground"})}),t.jsx("span",{className:"text-sm text-foreground font-medium",children:Me(h,"dd/MM/yyyy")}),t.jsx("span",{className:"text-sm text-foreground",children:e}),t.jsx("button",{className:"ml-auto p-1.5 bg-primary hover:bg-primary/90 rounded-lg transition-colors",children:t.jsx(ht,{className:"w-4 h-4 text-primary-foreground"})})]})]}),o&&t.jsxs("div",{className:"space-y-4 p-4 bg-accent/30 rounded-xl border border-border",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"guardian-name",className:"text-sm font-medium text-foreground",children:["Name of Adult with Parental Responsibility",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsx("input",{type:"text",id:"guardian-name",value:l.guardianName,onChange:i=>x("guardianName",i.target.value),"aria-required":"true",className:"w-full px-4 py-3 bg-card border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"patient-age",className:"text-sm font-medium text-foreground",children:["Age of Patient",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsxs(Je,{value:l.patientAge,onValueChange:i=>x("patientAge",i),children:[t.jsx(Ke,{id:"patient-age","aria-required":"true",className:"w-full px-4 py-3 h-auto bg-card border border-border rounded-xl text-foreground",children:t.jsx(We,{placeholder:"Select age"})}),t.jsx(Xe,{children:Array.from({length:16},(i,p)=>t.jsxs(Re,{value:String(p),children:[p," ",p===1?"year":"years"]},p))})]})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(ze,{id:"guardianConfirm",checked:l.guardianConfirmed,onCheckedChange:i=>x("guardianConfirmed",i===!0),className:"mt-0.5"}),t.jsx("label",{htmlFor:"guardianConfirm",className:"text-sm text-muted-foreground leading-relaxed cursor-pointer",children:"I confirm that I have parental responsibility for this child, and will be present at the blood draw. (We will need to check your ID)"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"patient-name",className:"text-sm font-medium text-foreground",children:["Patient Name",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsx("input",{type:"text",id:"patient-name",value:l.name,onChange:i=>x("name",i.target.value),"aria-required":"true",className:"w-full px-4 py-3 bg-card border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"patient-email",className:"text-sm font-medium text-foreground",children:["Your Email",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsx("input",{type:"email",id:"patient-email",value:l.email,onChange:i=>x("email",i.target.value),"aria-required":"true",className:"w-full px-4 py-3 bg-card border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]})]}),a.length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{htmlFor:"saved-address",className:"text-sm font-medium text-foreground",children:"Saved Addresses"}),t.jsxs(Je,{value:m,onValueChange:u,children:[t.jsx(Ke,{id:"saved-address",className:"w-full px-4 py-3 h-auto bg-card border border-border rounded-xl text-foreground",children:t.jsx(We,{placeholder:"Select a saved address or enter new"})}),t.jsxs(Xe,{children:[a.map(i=>t.jsx(Re,{value:i.id,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(st,{className:"w-4 h-4 mt-0.5 shrink-0 text-muted-foreground"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:i.label}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[i.address_line1,", ",i.town_city,", ",i.postcode]})]})]})},i.id)),t.jsx(Re,{value:"new",children:t.jsx("div",{className:"font-medium",children:"Enter new address"})})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"patient-address",className:"text-sm font-medium text-foreground",children:["Address 1",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsx("input",{type:"text",id:"patient-address",value:l.address1,onChange:i=>x("address1",i.target.value),"aria-required":"true",className:"w-full px-4 py-3 bg-card border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{htmlFor:"patient-address2",className:"text-sm font-medium text-foreground",children:"Address 2"}),t.jsx("input",{type:"text",id:"patient-address2",value:l.address2,onChange:i=>x("address2",i.target.value),className:"w-full px-4 py-3 bg-card border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"patient-city",className:"text-sm font-medium text-foreground",children:["City",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsx("input",{type:"text",id:"patient-city",value:l.city,onChange:i=>x("city",i.target.value),"aria-required":"true",className:"w-full px-4 py-3 bg-card border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"patient-postcode",className:"text-sm font-medium text-foreground",children:["Post Code",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsx("input",{type:"text",id:"patient-postcode",value:l.postCode,onChange:i=>x("postCode",i.target.value.toUpperCase()),"aria-required":"true",className:"w-full px-4 py-3 bg-card border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"patient-phone",className:"text-sm font-medium text-foreground",children:["Phone",t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsx("input",{type:"tel",id:"patient-phone",value:l.phone,onChange:i=>x("phone",i.target.value),"aria-required":"true",className:"w-full px-4 py-3 bg-card border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),n&&m==="new"&&t.jsxs("div",{className:"flex items-start gap-3 p-4 bg-accent/30 rounded-xl border border-border",children:[t.jsx(ze,{id:"saveAddress",checked:s,onCheckedChange:i=>y(i===!0),className:"mt-0.5"}),t.jsx("label",{htmlFor:"saveAddress",className:"text-sm text-foreground leading-relaxed cursor-pointer",children:"Save this address to my profile for future bookings"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-foreground",children:"Notes"}),t.jsx("textarea",{value:l.notes,onChange:i=>x("notes",i.target.value),placeholder:"Please tell us anything else we might need to know about your requirements including: details about specific collection(s), availability or accessibility restrictions, or previous problems you may have had having your blood taken.",rows:4,className:"w-full px-4 py-3 bg-card border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary resize-none"})]})]}),t.jsx("div",{className:$("p-4 bg-background border-t border-border",r?"fixed bottom-0 left-0 right-0 lg:max-w-2xl":"mt-6"),children:t.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[!r&&t.jsx(Ie,{variant:"outline",onClick:c,className:"w-full lg:w-auto lg:min-w-[120px] py-4 h-auto rounded-2xl",children:"Back"}),t.jsx(Le,{onClick:w,disabled:!P,children:"Continue to Payment"})]})}),t.jsx(Ve,{})]});return r?t.jsx("div",{className:"min-h-screen bg-background pb-32",children:k}):k}function He(h,e){const{currency:o}=e,d=h.toFixed(o.decimalPlaces).replace(".",o.decimalSeparator).replace(/\B(?=(\d{3})+(?!\d))/g,o.thousandsSeparator);return o.position==="before"?`${o.symbol}${d}`:`${d}${o.symbol}`}function Bt(h){const e=Q.c(135),{phlebotomist:o,date:d,timeSlot:c,onPaymentComplete:r,onBack:n,standalone:a,userPaymentMethods:l}=h,j=a===void 0?!0:a;let m;e[0]!==l?(m=l===void 0?[]:l,e[0]=l,e[1]=m):m=e[1];const f=m,{t:s}=ot(),{region:y}=lt(),[u,x]=S.useState(""),[N,C]=S.useState(f.length===0),[P,w]=S.useState(""),[k,i]=S.useState(""),[p,v]=S.useState(""),[E,D]=S.useState(""),[_,g]=S.useState(!1),[b,M]=S.useState(!1);let A;e[2]!==u||e[3]!==f?(A=()=>{if(f.length>0&&!u){const B=f.find(It);B&&(x(B.id),C(!1))}},e[2]=u,e[3]=f,e[4]=A):A=e[4],S.useState(A);const R=At,T=Ft;let I;e[5]!==r?(I=async()=>{M(!0),await new Promise(Mt),M(!1),r()},e[5]=r,e[6]=I):I=e[6];const L=I,O=N?P.length>=19&&k.length>2&&p.length===5&&E.length>=3:u.length>0;let F;e[7]!==s?(F=s("Order Summary"),e[7]=s,e[8]=F):F=e[8];let Y;e[9]!==F?(Y=t.jsx("h2",{className:"text-sm font-medium text-muted-foreground mb-4",children:F}),e[9]=F,e[10]=Y):Y=e[10];let W;e[11]!==o.image||e[12]!==o.name?(W=t.jsx("img",{src:o.image,alt:o.name,className:"w-12 h-12 rounded-full object-cover"}),e[11]=o.image,e[12]=o.name,e[13]=W):W=e[13];let V;e[14]!==o.name?(V=t.jsx("p",{className:"font-medium text-foreground",children:o.name}),e[14]=o.name,e[15]=V):V=e[15];let X;e[16]!==s?(X=s("Blood Draw Service"),e[16]=s,e[17]=X):X=e[17];let q;e[18]!==X?(q=t.jsx("p",{className:"text-sm text-muted-foreground",children:X}),e[18]=X,e[19]=q):q=e[19];let U;e[20]!==q||e[21]!==V?(U=t.jsxs("div",{className:"flex-1",children:[V,q]}),e[20]=q,e[21]=V,e[22]=U):U=e[22];let H;e[23]!==U||e[24]!==W?(H=t.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-4 border-b border-border",children:[W,U]}),e[23]=U,e[24]=W,e[25]=H):H=e[25];let z;e[26]!==s?(z=s("Date"),e[26]=s,e[27]=z):z=e[27];let G;e[28]!==z?(G=t.jsx("span",{className:"text-muted-foreground",children:z}),e[28]=z,e[29]=G):G=e[29];let J;e[30]!==d?(J=Me(d,"EEE, MMM d"),e[30]=d,e[31]=J):J=e[31];let K;e[32]!==J?(K=t.jsx("span",{className:"text-foreground",children:J}),e[32]=J,e[33]=K):K=e[33];let Z;e[34]!==G||e[35]!==K?(Z=t.jsxs("div",{className:"flex justify-between",children:[G,K]}),e[34]=G,e[35]=K,e[36]=Z):Z=e[36];let ee;e[37]!==s?(ee=s("Time"),e[37]=s,e[38]=ee):ee=e[38];let te;e[39]!==ee?(te=t.jsx("span",{className:"text-muted-foreground",children:ee}),e[39]=ee,e[40]=te):te=e[40];let se;e[41]!==c?(se=t.jsx("span",{className:"text-foreground",children:c}),e[41]=c,e[42]=se):se=e[42];let re;e[43]!==te||e[44]!==se?(re=t.jsxs("div",{className:"flex justify-between",children:[te,se]}),e[43]=te,e[44]=se,e[45]=re):re=e[45];let ae;e[46]!==s?(ae=s("Service Fee"),e[46]=s,e[47]=ae):ae=e[47];let le;e[48]!==ae?(le=t.jsx("span",{className:"text-muted-foreground",children:ae}),e[48]=ae,e[49]=le):le=e[49];let oe;e[50]!==o.price||e[51]!==y?(oe=He(o.price,y),e[50]=o.price,e[51]=y,e[52]=oe):oe=e[52];let ne;e[53]!==oe?(ne=t.jsx("span",{className:"text-foreground",children:oe}),e[53]=oe,e[54]=ne):ne=e[54];let ie;e[55]!==le||e[56]!==ne?(ie=t.jsxs("div",{className:"flex justify-between",children:[le,ne]}),e[55]=le,e[56]=ne,e[57]=ie):ie=e[57];let ce;e[58]!==Z||e[59]!==re||e[60]!==ie?(ce=t.jsxs("div",{className:"space-y-2 text-sm",children:[Z,re,ie]}),e[58]=Z,e[59]=re,e[60]=ie,e[61]=ce):ce=e[61];let de;e[62]!==s?(de=s("Total"),e[62]=s,e[63]=de):de=e[63];let me;e[64]!==de?(me=t.jsx("span",{className:"font-semibold text-foreground",children:de}),e[64]=de,e[65]=me):me=e[65];let ue;e[66]!==o.price||e[67]!==y?(ue=He(o.price,y),e[66]=o.price,e[67]=y,e[68]=ue):ue=e[68];let xe;e[69]!==ue?(xe=t.jsx("span",{className:"font-bold text-lg text-foreground",children:ue}),e[69]=ue,e[70]=xe):xe=e[70];let fe;e[71]!==me||e[72]!==xe?(fe=t.jsxs("div",{className:"flex justify-between mt-4 pt-4 border-t border-border",children:[me,xe]}),e[71]=me,e[72]=xe,e[73]=fe):fe=e[73];let pe;e[74]!==H||e[75]!==ce||e[76]!==fe||e[77]!==Y?(pe=t.jsxs("div",{className:"bg-card border border-border rounded-3xl p-5",children:[Y,H,ce,fe]}),e[74]=H,e[75]=ce,e[76]=fe,e[77]=Y,e[78]=pe):pe=e[78];let $e;e[79]===Symbol.for("react.memo_cache_sentinel")?($e=t.jsx(Ze,{className:"w-4 h-4 text-muted-foreground"}),e[79]=$e):$e=e[79];let ge;e[80]!==s?(ge=s("Secure Payment"),e[80]=s,e[81]=ge):ge=e[81];let he;e[82]!==ge?(he=t.jsxs("div",{className:"flex items-center gap-2",children:[$e,t.jsx("span",{className:"text-sm text-muted-foreground",children:ge})]}),e[82]=ge,e[83]=he):he=e[83];let be;e[84]!==u||e[85]!==s||e[86]!==N||e[87]!==f?(be=f.length>0&&!N&&t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"text-sm font-medium text-foreground",children:s("Select Payment Method")}),t.jsx("div",{className:"space-y-2",children:f.map(B=>t.jsx("button",{type:"button",onClick:()=>x(B.id),className:$("w-full p-4 bg-card border rounded-2xl text-left transition-all",u===B.id?"border-primary ring-2 ring-primary/20":"border-border hover:border-primary/50"),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-accent rounded-lg flex items-center justify-center",children:t.jsx(Qe,{className:"w-5 h-5 text-foreground"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"font-medium text-foreground capitalize",children:[B.card_brand," •••• ",B.card_last_four]}),t.jsxs("div",{className:"text-sm text-muted-foreground",children:[s("Expires")," ",B.card_exp_month,"/",B.card_exp_year]})]})]}),u===B.id&&t.jsx("div",{className:"w-6 h-6 bg-primary rounded-full flex items-center justify-center",children:t.jsx(rt,{className:"w-4 h-4 text-primary-foreground"})})]})},B.id))}),t.jsx(Ie,{type:"button",variant:"outline",onClick:()=>C(!0),className:"w-full rounded-2xl py-3 h-auto",children:s("Use a different card")})]}),e[84]=u,e[85]=s,e[86]=N,e[87]=f,e[88]=be):be=e[88];let je;e[89]!==k||e[90]!==P||e[91]!==E||e[92]!==p||e[93]!==_||e[94]!==s||e[95]!==N||e[96]!==f?(je=N&&t.jsxs("div",{className:"space-y-3",children:[f.length>0&&t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"text-sm font-medium text-foreground",children:s("Enter Card Details")}),t.jsx(Ie,{type:"button",variant:"ghost",size:"sm",onClick:()=>C(!1),className:"text-xs",children:s("Use saved card")})]}),t.jsxs("div",{className:"relative",children:[t.jsx(Qe,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),t.jsx("input",{type:"text",value:P,onChange:B=>w(R(B.target.value)),placeholder:s("Card number"),maxLength:19,className:"w-full pl-12 pr-4 py-4 bg-card border border-border rounded-2xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"})]}),t.jsxs("div",{className:"relative",children:[t.jsx(bt,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),t.jsx("input",{type:"text",value:k,onChange:B=>i(B.target.value),placeholder:s("Cardholder name"),className:"w-full pl-12 pr-4 py-4 bg-card border border-border rounded-2xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ge,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),t.jsx("input",{type:"text",value:p,onChange:B=>v(T(B.target.value)),placeholder:s("MM/YY"),maxLength:5,className:"w-full pl-12 pr-4 py-4 bg-card border border-border rounded-2xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"})]}),t.jsxs("div",{className:"relative",children:[t.jsx(Ze,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),t.jsx("input",{type:"text",value:E,onChange:B=>D(B.target.value.replace(/\D/g,"")),placeholder:s("CVV"),maxLength:4,className:"w-full pl-12 pr-4 py-4 bg-card border border-border rounded-2xl text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"})]})]}),f!==void 0&&t.jsxs("div",{className:"flex items-start gap-3 p-4 bg-accent/30 rounded-xl border border-border",children:[t.jsx(ze,{id:"saveCard",checked:_,onCheckedChange:B=>g(B===!0),className:"mt-0.5"}),t.jsx("label",{htmlFor:"saveCard",className:"text-sm text-foreground leading-relaxed cursor-pointer",children:s("Save this card to my profile for future bookings")})]})]}),e[89]=k,e[90]=P,e[91]=E,e[92]=p,e[93]=_,e[94]=s,e[95]=N,e[96]=f,e[97]=je):je=e[97];let ye;e[98]!==s?(ye=s("Your payment information is encrypted and secure"),e[98]=s,e[99]=ye):ye=e[99];let Ne;e[100]!==ye?(Ne=t.jsx("p",{className:"text-xs text-muted-foreground text-center",children:ye}),e[100]=ye,e[101]=Ne):Ne=e[101];let ve;e[102]!==he||e[103]!==be||e[104]!==je||e[105]!==Ne?(ve=t.jsxs("div",{className:"space-y-4",children:[he,be,je,Ne]}),e[102]=he,e[103]=be,e[104]=je,e[105]=Ne,e[106]=ve):ve=e[106];let Se;e[107]!==pe||e[108]!==ve?(Se=t.jsxs("div",{className:"space-y-6",children:[pe,ve]}),e[107]=pe,e[108]=ve,e[109]=Se):Se=e[109];const qe=j?"fixed bottom-0 left-0 right-0 lg:max-w-2xl":"mt-6";let Ce;e[110]!==qe?(Ce=$("p-4 bg-background border-t border-border",qe),e[110]=qe,e[111]=Ce):Ce=e[111];let we;e[112]!==s?(we=s("Back"),e[112]=s,e[113]=we):we=e[113];let ke;e[114]!==n||e[115]!==we?(ke=t.jsx(Ie,{variant:"outline",onClick:n,className:"w-full lg:w-auto lg:min-w-[120px] py-4 h-auto rounded-2xl lg:order-first order-last",children:we}),e[114]=n,e[115]=we,e[116]=ke):ke=e[116];const Ue=!O||b;let _e;e[117]!==b||e[118]!==o.price||e[119]!==y||e[120]!==s?(_e=b?s("Processing..."):s("Pay {{amount}}",{amount:He(o.price,y)}),e[117]=b,e[118]=o.price,e[119]=y,e[120]=s,e[121]=_e):_e=e[121];let Pe;e[122]!==L||e[123]!==Ue||e[124]!==_e?(Pe=t.jsx(Le,{onClick:L,disabled:Ue,children:_e}),e[122]=L,e[123]=Ue,e[124]=_e,e[125]=Pe):Pe=e[125];let De;e[126]!==ke||e[127]!==Pe?(De=t.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[ke,Pe]}),e[126]=ke,e[127]=Pe,e[128]=De):De=e[128];let Ee;e[129]!==Ce||e[130]!==De?(Ee=t.jsx("div",{className:Ce,children:De}),e[129]=Ce,e[130]=De,e[131]=Ee):Ee=e[131];let Te;return e[132]!==Se||e[133]!==Ee?(Te=t.jsxs("div",{className:"pb-32 animate-fade-in",children:[Se,Ee]}),e[132]=Se,e[133]=Ee,e[134]=Te):Te=e[134],Te}function Mt(h){return setTimeout(h,2e3)}function Ft(h){const e=h.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return e.length>=2?e.substring(0,2)+"/"+e.substring(2,4):e}function At(h){const o=h.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),d=o&&o[0]||"",c=[];for(let r=0,n=d.length;r<n;r=r+4,r)c.push(d.substring(r,r+4));return c.length?c.join(" "):h}function It(h){return h.is_default}const tt=[{id:"location",title:"Location & Schedule"},{id:"phlebotomist",title:"Select Phlebotomist"},{id:"details",title:"Patient Details"},{id:"payment",title:"Payment"},{id:"success",title:"Confirmation"}];function Ae(h){const e=Q.c(8),{currentStep:o,onStepClick:d}=h;let c;e[0]!==o?(c=j=>j.id===o,e[0]=o,e[1]=c):c=e[1];const r=tt.findIndex(c);let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx("h2",{className:"text-lg font-semibold mb-4 text-foreground",children:"Booking Steps"}),e[2]=n):n=e[2];let a;e[3]!==r||e[4]!==d?(a=tt.map((j,m)=>{const f=m<r,s=m===r,y=m>r,u=f,x=u?"button":"div";return t.jsx("li",{children:t.jsxs(x,{onClick:u?()=>d?.(j.id):void 0,className:$("flex items-center gap-3 p-3 rounded-lg transition-colors w-full text-left",s&&"bg-primary/10 text-primary",f&&"text-muted-foreground hover:bg-muted cursor-pointer",y&&"text-muted-foreground/50"),"aria-current":s?"step":void 0,children:[t.jsx("div",{className:$("w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors shrink-0",s&&"bg-primary text-primary-foreground",f&&"bg-green-500 text-white",y&&"bg-muted text-muted-foreground"),children:f?t.jsx(rt,{className:"w-4 h-4","aria-hidden":"true"}):t.jsx("span",{children:m+1})}),t.jsx("span",{className:"font-medium text-sm",children:j.title})]})},j.id)}),e[3]=r,e[4]=d,e[5]=a):a=e[5];let l;return e[6]!==a?(l=t.jsx("aside",{className:"hidden lg:block",children:t.jsxs("div",{className:"sticky top-20",children:[n,t.jsx("nav",{"aria-label":"Booking progress",children:t.jsx("ol",{className:"space-y-2",children:a})})]})}),e[6]=a,e[7]=l):l=e[7],l}function Lt({isUnder16:h=!1,mapboxToken:e,userData:o=null,userAddresses:d=[],userPaymentMethods:c=[]}){const r="booking_draft",[n,a]=S.useState("location"),[l,j]=S.useState(new Date),[m,f]=S.useState(null),[s,y]=S.useState(""),[u,x]=S.useState(null),[N,C]=S.useState(null),[P,w]=S.useState(null);S.useEffect(()=>{try{const g=localStorage.getItem(r);if(g){const b=JSON.parse(g);b.selectedDate&&j(new Date(b.selectedDate)),b.selectedSlot&&f(b.selectedSlot),b.address&&y(b.address),b.selectedPhlebotomist&&x(b.selectedPhlebotomist),b.patientDetails&&C(b.patientDetails),b.step&&a(b.step)}}catch(g){console.error("Error loading booking draft:",g)}},[]),S.useEffect(()=>{if(n!=="success")try{const g={step:n,selectedDate:l.toISOString(),selectedSlot:m,address:s,selectedPhlebotomist:u,patientDetails:N};localStorage.setItem(r,JSON.stringify(g))}catch(g){console.error("Error saving booking draft:",g)}},[n,l,m,s,u,N]);const k=()=>{switch(n){case"location":Oe.visit("/");break;case"phlebotomist":a("location");break;case"details":a("phlebotomist");break;case"payment":a("details");break;default:Oe.visit("/")}},i=(g,b,M)=>{y(g),j(b),f(M),a("phlebotomist")},p=g=>{x(g),a("details")},v=g=>{C(g),y(g.address1),a("payment")},E=async()=>{if(u&&m)try{const g=await fetch("/api/bookings",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({phlebotomist_id:u.id,appointment_date:l.toISOString().split("T")[0],time_slot:m,address:s,patient_details:N})});if(g.ok){const b=await g.json();w(b.id)}else Be.error("Booking saved locally",{description:"Your appointment is confirmed but chat will be available after sign in."})}catch(g){console.error("Error saving booking:",g),Be.error("Booking saved locally",{description:"Your appointment is confirmed but chat will be available after sign in."})}try{localStorage.removeItem(r)}catch(g){console.error("Error clearing booking draft:",g)}a("success")},D=()=>{Oe.visit("/")},_=g=>{const b=["location","phlebotomist","details","payment","success"],M=b.indexOf(n);b.indexOf(g)<M&&a(g)};return n==="location"?t.jsxs(t.Fragment,{children:[t.jsx(Fe,{title:"Book Your Appointment"}),t.jsx("div",{className:"min-h-screen bg-background",children:t.jsx("div",{className:"container mx-auto px-4 py-8",children:t.jsxs("div",{className:"lg:grid lg:grid-cols-[250px_1fr] lg:gap-8",children:[t.jsx(Ae,{currentStep:n,onStepClick:_}),t.jsx("main",{className:"max-w-2xl lg:mx-0 mx-auto",children:t.jsx(_t,{onContinue:i,onBack:k,standalone:!1})})]})})})]}):n==="phlebotomist"&&m?t.jsxs(t.Fragment,{children:[t.jsx(Fe,{title:"Select Phlebotomist"}),t.jsx("div",{className:"min-h-screen bg-background",children:t.jsx("div",{className:"container mx-auto px-4 py-8",children:t.jsxs("div",{className:"lg:grid lg:grid-cols-[250px_1fr] lg:gap-8",children:[t.jsx(Ae,{currentStep:n,onStepClick:_}),t.jsx("main",{className:"max-w-2xl lg:mx-0 mx-auto",children:t.jsx(Pt,{date:l,timeSlot:m,onContinue:p,onBack:k,standalone:!1})})]})})})]}):n==="details"&&m?t.jsxs(t.Fragment,{children:[t.jsx(Fe,{title:"Patient Details"}),t.jsx("div",{className:"min-h-screen bg-background",children:t.jsx("div",{className:"container mx-auto px-4 py-8",children:t.jsxs("div",{className:"lg:grid lg:grid-cols-[250px_1fr] lg:gap-8",children:[t.jsx(Ae,{currentStep:n,onStepClick:_}),t.jsx("main",{className:"max-w-2xl lg:mx-0 mx-auto",children:t.jsx(Et,{date:l,timeSlot:m,isUnder16:h,onContinue:v,onBack:k,standalone:!1,userData:o,userAddresses:d})})]})})})]}):n==="payment"&&m&&u?t.jsxs(t.Fragment,{children:[t.jsx(Fe,{title:"Payment"}),t.jsxs("div",{className:"min-h-screen bg-background",children:[t.jsx("div",{className:"container mx-auto px-4 py-8",children:t.jsxs("div",{className:"lg:grid lg:grid-cols-[250px_1fr] lg:gap-8",children:[t.jsx(Ae,{currentStep:n,onStepClick:_}),t.jsxs("main",{className:"max-w-2xl lg:mx-0 mx-auto",children:[t.jsx("div",{className:"lg:hidden",children:t.jsx(Ye,{title:"Payment",onBack:k})}),t.jsx("div",{className:"hidden lg:block mb-6",children:t.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:"Payment"})}),t.jsx(Bt,{phlebotomist:u,date:l,timeSlot:m,onPaymentComplete:E,onBack:k,standalone:!1,userPaymentMethods:c})]})]})}),t.jsx(Ve,{})]})]}):n==="success"&&m&&u?t.jsxs(t.Fragment,{children:[t.jsx(Fe,{title:"Booking Confirmed"}),t.jsx("div",{className:"min-h-screen bg-background",children:t.jsx("div",{className:"container mx-auto px-4 py-8",children:t.jsxs("div",{className:"lg:grid lg:grid-cols-[250px_1fr] lg:gap-8",children:[t.jsx(Ae,{currentStep:n,onStepClick:_}),t.jsx("main",{className:"max-w-2xl lg:mx-0 mx-auto",children:t.jsx(Nt,{date:l,timeSlot:m,bookingId:P,phlebotomist:u,onDone:D})})]})})})]}):null}Lt.layout=h=>t.jsx(nt,{hideFooter:!0,children:h});export{Lt as default};
